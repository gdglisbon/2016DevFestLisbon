<!--
@license
Copyright (c) 2016 SyncRTC Inc. All rights reserved.
This code may only be used under the MIT style license found at LICENSE.md
-->

<link rel="import" href="../polymer/polymer.html">

<!--
`stripe-behavior`
Behavior wrapper for the Stripe library

-->
<script>

  (function () {
    'use strict';

    HOVERBOARD.StripeBehavior = {

      properties: {
        Stripe: {
          type: Object,
        },

        publisheableKey: {
          type: String
        }
      },

      _initStripe: function(){
        this.Stripe = Stripe;
        this.Stripe.setPublishableKey(this.publisheableKey);
      },

      _stripeExists: function(){
        return typeof Stripe != "undefined";
      },

      _loadStripe: function(){
        if(this._stripeExists()){
          return;
        }

        var scriptStripe = document.createElement('script');
        scriptStripe.src = "https://js.stripe.com/v2/";
        document.head.appendChild(scriptStripe);

        var scriptJQuery = document.createElement('script');
        scriptJQuery.src = "https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js";
        document.head.appendChild(scriptJQuery);

        var scriptTicketStripe = document.createElement('script');
        scriptTicketStripe.type  = "text/javascript";
        scriptTicketStripe.src = "../../ticket-stripe.js";
        document.head.appendChild(scriptTicketStripe);

        scriptStripe.onload = this._initStripe.bind(this);
        scriptJQuery.onload = this._initStripe.bind(this);
        scriptTicketStripe.onload = this._initStripe.bind(this);
      },

      created: function() {
        this._loadStripe();
      },
  };

  }());
</script>
